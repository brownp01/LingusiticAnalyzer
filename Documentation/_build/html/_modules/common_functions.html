
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>common_functions &#8212; Linguistic Analyzer 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Linguistic Analyzer 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for common_functions</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">werkzeug.utils</span> <span class="k">import</span> <span class="n">secure_filename</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">functionsv1</span> <span class="k">import</span> <span class="n">common_functions</span>
<span class="kn">from</span> <span class="nn">functionsv1</span> <span class="k">import</span> <span class="n">analyze_functions</span>
<span class="kn">from</span> <span class="nn">Keyword</span> <span class="k">import</span> <span class="n">Keyword</span>
<span class="kn">from</span> <span class="nn">werkzeug.datastructures</span> <span class="k">import</span> <span class="n">FileStorage</span>
<span class="kn">import</span> <span class="nn">docx</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">pdfminer.pdfinterp</span> <span class="k">import</span> <span class="n">PDFResourceManager</span><span class="p">,</span> <span class="n">PDFPageInterpreter</span>
<span class="kn">from</span> <span class="nn">pdfminer.converter</span> <span class="k">import</span> <span class="n">TextConverter</span>
<span class="kn">from</span> <span class="nn">pdfminer.layout</span> <span class="k">import</span> <span class="n">LAParams</span>
<span class="kn">from</span> <span class="nn">pdfminer.pdfpage</span> <span class="k">import</span> <span class="n">PDFPage</span>
<span class="kn">import</span> <span class="nn">Keyword</span>
<span class="kn">from</span> <span class="nn">KeywordList</span> <span class="k">import</span> <span class="n">KeywordList</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">DOWNLOAD_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;downloads/&#39;</span>
<span class="n">REGULATOR_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;RegulatoryDocuments/&#39;</span>

<div class="viewcode-block" id="homeCount"><a class="viewcode-back" href="../functionsv1.html#common_functions.homeCount">[docs]</a><span class="k">def</span> <span class="nf">homeCount</span><span class="p">():</span>

    <span class="n">returnVal</span> <span class="o">=</span> <span class="n">homeCount</span><span class="o">.</span><span class="n">counter</span>
    <span class="n">homeCount</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">returnVal</span></div>


<span class="n">homeCount</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>


<span class="c1"># going to handle all the mess that is in app.py</span>
<div class="viewcode-block" id="interpretfile"><a class="viewcode-back" href="../functionsv1.html#common_functions.interpretfile">[docs]</a><span class="k">def</span> <span class="nf">interpretfile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localuploadfolder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Summary: Parses uploaded file&#39;s text, identifies keywords, analyzes keywords, and returns a list of Keyword Objects</span>
<span class="sd">        @param file: werkzeug filestorage object</span>
<span class="sd">        @type file: werkzeug filestorage object</span>
<span class="sd">        @param localuploadfolder:</span>
<span class="sd">        @type localuploadfolder: string</span>
<span class="sd">        @return: keywordlist</span>
<span class="sd">        @rtype: KeywordList</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># -----------GRABBING TEXT FROM FILE----------- #</span>
    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
        <span class="n">file_text</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">extractpdftext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localuploadfolder</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;docx&#39;</span><span class="p">:</span>
        <span class="n">file_text</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">extractmicrosoftdocxtext</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="c1"># common_functions.printStringList(file_text)</span>

    <span class="c1"># -----------IDENTIFYING KEYWORDS----------- #</span>
    <span class="n">keyword_list</span> <span class="o">=</span> <span class="n">analyze_functions</span><span class="o">.</span><span class="n">identifykeywords</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span>

    <span class="c1"># -----------CALCULATING VARIOUS SCORES FOR EACH KEYWORD----------- #</span>
    <span class="n">analyze_functions</span><span class="o">.</span><span class="n">calculatescores</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">,</span> <span class="n">file_text</span><span class="p">)</span>
    <span class="n">keyword_list</span><span class="o">.</span><span class="n">calculateavgscores</span><span class="p">()</span>

    <span class="c1"># -----------PUTTING KEYWORDS IN FILE----------- #</span>
    <span class="n">common_functions</span><span class="o">.</span><span class="n">outputkeywordtotext</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">keyword_list</span></div>


<div class="viewcode-block" id="interpretexistingfile"><a class="viewcode-back" href="../functionsv1.html#common_functions.interpretexistingfile">[docs]</a><span class="k">def</span> <span class="nf">interpretexistingfile</span><span class="p">(</span><span class="n">regfilename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Parses, identifies keywords and analyzes content of chosen regulatory file document is being compares against.</span>
<span class="sd">    @param regfilename: name of file without file ending</span>
<span class="sd">    @type regfilename: string</span>
<span class="sd">    @return: list of kwywords that have been analyzed</span>
<span class="sd">    @rtype: KeywordList</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reg_text</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">getregulatorydoctext</span><span class="p">(</span><span class="n">regfilename</span><span class="p">)</span>
    <span class="n">reg_keyword_list</span> <span class="o">=</span> <span class="n">analyze_functions</span><span class="o">.</span><span class="n">identifykeywords</span><span class="p">(</span><span class="n">reg_text</span><span class="p">)</span>
    <span class="n">analyze_functions</span><span class="o">.</span><span class="n">calculatescores</span><span class="p">(</span><span class="n">reg_keyword_list</span><span class="p">,</span> <span class="n">reg_text</span><span class="p">)</span>
    <span class="n">reg_keyword_list</span><span class="o">.</span><span class="n">calculateavgscores</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">reg_keyword_list</span></div>


<div class="viewcode-block" id="getscorepage"><a class="viewcode-back" href="../functionsv1.html#common_functions.getscorepage">[docs]</a><span class="k">def</span> <span class="nf">getscorepage</span><span class="p">(</span><span class="n">kw_list</span><span class="p">,</span> <span class="n">reg_kw_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Returns html page that is populated with proper calculated Keyword, Comparison, and Yule&#39;s scores.</span>
<span class="sd">    @param kw_list: user document&#39;s keyword list</span>
<span class="sd">    @type kw_list: KeywordList</span>
<span class="sd">    @param reg_kw_list: regulatory document&#39;s keyword list</span>
<span class="sd">    @type reg_kw_list: KeywordList</span>
<span class="sd">    @return: html text</span>
<span class="sd">    @rtype: string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;views/score_response.html&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">returnhtml</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--KEYWORD_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getavgkeywordscore</span><span class="p">()))</span><span class="o">.</span> \
        <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--YULESK_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getyuleskscore</span><span class="p">()))</span>\
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--DOCUMENT_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getdocumentscore</span><span class="p">()))</span>\
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--COMPARISON_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">analyze_functions</span><span class="o">.</span><span class="n">calculatecomparisonscore</span><span class="p">(</span><span class="n">kw_list</span><span class="p">,</span> <span class="n">reg_kw_list</span><span class="p">)))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--REG_YULESK_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">getyuleskscore</span><span class="p">()))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--YULESI_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getyulesiscore</span><span class="p">()))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--REG_YULESI_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">getyulesiscore</span><span class="p">()))</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">returnhtml</span></div>


<div class="viewcode-block" id="geterrorpage"><a class="viewcode-back" href="../functionsv1.html#common_functions.geterrorpage">[docs]</a><span class="k">def</span> <span class="nf">geterrorpage</span><span class="p">(</span><span class="n">errtext</span><span class="o">=</span><span class="s2">&quot;Unknown Error&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Populates error mpge with proper response and returns html</span>
<span class="sd">    @param errtext: text of error</span>
<span class="sd">    @type errtext: string</span>
<span class="sd">    @return: html page</span>
<span class="sd">    @rtype: string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Returns error page</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;views/invalid_upload.html&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">returnhtml</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;##ERROR##&#39;</span><span class="p">,</span> <span class="n">errtext</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">returnhtml</span></div>


<div class="viewcode-block" id="extractpdftext"><a class="viewcode-back" href="../functionsv1.html#common_functions.extractpdftext">[docs]</a><span class="k">def</span> <span class="nf">extractpdftext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">testdownload_folder</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">RegDoc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Extracts Text from PDF document referenced in given file argument</span>
<span class="sd">    @param file: the object containing the file&#39;s information</span>
<span class="sd">    @type file: fileStorage</span>
<span class="sd">    @return: list containing the text of the PDF</span>
<span class="sd">    @rtype: List[string]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># -- This is for testing, do not remove -- #</span>
        <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">RegDoc</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">DOWNLOAD_FOLDER</span>
            <span class="n">savefile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localdownload_folder</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">testdownload_folder</span>


        <span class="c1"># PdfMiner writes an insane amount of logging statements (one per parsed word, it seems).</span>
        <span class="c1"># Remove the below line if you would like to see them.</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
        <span class="c1"># ----------This is the PDFMiner.six PDF Reader ----------#</span>
        <span class="n">pages</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">pagenums</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pagenums</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">PDFResourceManager</span><span class="p">()</span>
        <span class="n">converter</span> <span class="o">=</span> <span class="n">TextConverter</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="n">LAParams</span><span class="p">())</span>
        <span class="n">interpreter</span> <span class="o">=</span> <span class="n">PDFPageInterpreter</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">converter</span><span class="p">)</span>

        <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">localdownload_folder</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">PDFPage</span><span class="o">.</span><span class="n">get_pages</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">pagenums</span><span class="p">):</span>
            <span class="n">interpreter</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
        <span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">converter</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>        <span class="c1"># Worry - An incredibly long string may crash our application</span>
        <span class="n">output</span><span class="o">.</span><span class="n">close</span>
        <span class="c1"># --------End of PDFMiner reading --------#</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span> <span class="c1"># This re-enables logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PDF file processed&quot;</span><span class="p">)</span>

        <span class="n">file_text</span> <span class="o">=</span> <span class="n">longstringtostringlist</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>  <span class="c1"># Converting long string to list of strings of size 1024</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">fnfe</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;**-- ERROR: unable to find file file --**&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fnfe</span><span class="o">.</span><span class="n">strerror</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">RegDoc</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>       <span class="c1"># If this is not a test, remove file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">localdownload_folder</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>  <span class="c1"># Removes created file from directory.</span>
    <span class="k">return</span> <span class="n">cleantext</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span></div>


<div class="viewcode-block" id="extractmicrosoftdocxtext"><a class="viewcode-back" href="../functionsv1.html#common_functions.extractmicrosoftdocxtext">[docs]</a><span class="k">def</span> <span class="nf">extractmicrosoftdocxtext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">testdownload_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Extracts text from any &quot;.docx&quot; document and returns it.</span>
<span class="sd">    @param file: doc file</span>
<span class="sd">    @type file: werkzeug filestorage</span>
<span class="sd">    @param testdownload_folder: path to test upload folder if necessary</span>
<span class="sd">    @type testdownload_folder: string</span>
<span class="sd">    @return: file&#39;s text</span>
<span class="sd">    @rtype: List[string]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">DOWNLOAD_FOLDER</span>
            <span class="n">savefile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localdownload_folder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">testdownload_folder</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">(</span><span class="n">localdownload_folder</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">para</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">para</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">file_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">para</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">fnfe</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;**-- ERROR: unable to find file file --**&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fnfe</span><span class="o">.</span><span class="n">strerror</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># Removes created file from directory.</span>
    <span class="k">return</span> <span class="n">cleantext</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span></div>


<div class="viewcode-block" id="savefile"><a class="viewcode-back" href="../functionsv1.html#common_functions.savefile">[docs]</a><span class="k">def</span> <span class="nf">savefile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># -- This is for testing, do not remove -- #</span>
    <span class="k">if</span><span class="p">(</span><span class="n">download_folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">DOWNLOAD_FOLDER</span> <span class="o">=</span> <span class="n">download_folder</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">secure_filename</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;saving file &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>  <span class="c1"># saves uploaded files</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot; saved&#39;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;opening file &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>  <span class="c1"># Logging</span></div>


<div class="viewcode-block" id="outputkeywordtotext"><a class="viewcode-back" href="../functionsv1.html#common_functions.outputkeywordtotext">[docs]</a><span class="k">def</span> <span class="nf">outputkeywordtotext</span><span class="p">(</span><span class="n">keylist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This function will write Keywords from an analyzed document to a .txt file</span>
<span class="sd">    @param keylist: KeywordList object containing keywords from analyzed document</span>
<span class="sd">    @type object: KeywordList</span>
<span class="sd">    @return: void</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO create file using document title of originating keywords</span>
    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Documents/Keywords.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keylist</span><span class="o">.</span><span class="n">uniquekeywords</span><span class="p">):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">sal</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span>
        <span class="n">keyscore</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keywordscore</span>

        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">word</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">keyscore</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="extractkeywordfromtxt"><a class="viewcode-back" href="../functionsv1.html#common_functions.extractkeywordfromtxt">[docs]</a><span class="k">def</span> <span class="nf">extractkeywordfromtxt</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This function will extract keyword information from .txt file and place into KeywordList object</span>
<span class="sd">    @param file: location of .txt file</span>
<span class="sd">    @type file: .txt</span>
<span class="sd">    @return: void</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keyword_list</span> <span class="o">=</span> <span class="n">KeywordList</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">sal</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">keyscore</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># TODO modify input to Keyword Object to fit overall needs</span>
        <span class="n">newKeyword</span> <span class="o">=</span> <span class="n">Keyword</span><span class="o">.</span><span class="n">Keyword</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">sal</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">keyscore</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))))</span>
        <span class="n">keyword_list</span><span class="o">.</span><span class="n">insertkeyword</span><span class="p">(</span><span class="n">newKeyword</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">keyword_list</span></div>


<div class="viewcode-block" id="cleantext"><a class="viewcode-back" href="../functionsv1.html#common_functions.cleantext">[docs]</a><span class="k">def</span> <span class="nf">cleantext</span><span class="p">(</span><span class="n">text_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary:</span>
<span class="sd">    @param textlist: a list of strings to remove strange characters from</span>
<span class="sd">    @type textlist:</span>
<span class="sd">    @return:</span>
<span class="sd">    @rtype:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">printable</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">text_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">,</span> <span class="n">text_list</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">text_list</span></div>

<div class="viewcode-block" id="printStringList"><a class="viewcode-back" href="../functionsv1.html#common_functions.printStringList">[docs]</a><span class="k">def</span> <span class="nf">printStringList</span><span class="p">(</span><span class="n">textList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Helper function that prints a list of strins</span>
<span class="sd">    @param textList: file&#39;s text</span>
<span class="sd">    @type textList: List[string]</span>
<span class="sd">    @rtype: void</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">textList</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">textList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>

<div class="viewcode-block" id="longstringtostringlist"><a class="viewcode-back" href="../functionsv1.html#common_functions.longstringtostringlist">[docs]</a><span class="k">def</span> <span class="nf">longstringtostringlist</span><span class="p">(</span><span class="n">longstring</span><span class="p">,</span> <span class="n">strsize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This functions splits a long string &quot;longstring&quot; into strings of size &quot;strsize&quot; and returns a list of strs</span>
<span class="sd">    @param longstring:  long string to parse through</span>
<span class="sd">    @type longstring:</span>
<span class="sd">    @param strsize: size of strings to populate list with</span>
<span class="sd">    @type strsize:  int</span>
<span class="sd">    @return:</span>
<span class="sd">    @rtype:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">return_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">longstring</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">strsize</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">longstring</span><span class="p">),</span> <span class="n">strsize</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="stringlisttolonglongstring"><a class="viewcode-back" href="../functionsv1.html#common_functions.stringlisttolonglongstring">[docs]</a><span class="k">def</span> <span class="nf">stringlisttolonglongstring</span><span class="p">(</span><span class="n">string_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Helper function to turn list of string into one long long string</span>
<span class="sd">    @param string_list: file&#39;s text</span>
<span class="sd">    @type string_list: List[string]</span>
<span class="sd">    @return: file&#39;s text</span>
<span class="sd">    @rtype: long string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">long_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">string_list</span><span class="p">)):</span>
        <span class="n">long_string</span> <span class="o">+=</span> <span class="n">string_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">long_string</span></div>


<div class="viewcode-block" id="createkeywordfromgoogleapientity"><a class="viewcode-back" href="../functionsv1.html#common_functions.createkeywordfromgoogleapientity">[docs]</a><span class="k">def</span> <span class="nf">createkeywordfromgoogleapientity</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">file_text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Creates a Keyword from a single entity that is returned by the google API</span>
<span class="sd">    @param entity: google API response entity</span>
<span class="sd">    @type entity: google API response entity</span>
<span class="sd">    @param file_text: entire file&#39;s text</span>
<span class="sd">    @type file_text: list of strings</span>
<span class="sd">    @return: populated instance of Keyword class</span>
<span class="sd">    @rtype: Keyword</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">eName</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">name</span>
    <span class="n">eType</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">type</span>
    <span class="n">eSal</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">salience</span>
    <span class="n">eFreq</span> <span class="o">=</span> <span class="n">getwordfrequency</span><span class="p">(</span><span class="n">eName</span><span class="p">,</span> <span class="n">file_text</span><span class="p">)</span>

    <span class="c1"># newKeyword = Keyword.creacreatenewkeyword_overload_1(entity.name.upper(), entity.type, getwordfrequency(entity.name, file_text), entity.salience)</span>
    <span class="n">newKeyword</span> <span class="o">=</span> <span class="n">Keyword</span><span class="o">.</span><span class="n">Keyword</span><span class="p">(</span><span class="n">eName</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">eType</span><span class="p">,</span> <span class="n">eSal</span><span class="p">,</span> <span class="n">eFreq</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># the value 0 refers to default keywordscore</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">entity</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">newKeyword</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">newKeyword</span></div>


<div class="viewcode-block" id="appendtokeywordlist"><a class="viewcode-back" href="../functionsv1.html#common_functions.appendtokeywordlist">[docs]</a><span class="k">def</span> <span class="nf">appendtokeywordlist</span><span class="p">(</span><span class="n">kList</span><span class="p">,</span> <span class="n">newK</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Checks for duplicate keywords and etc. etc. before potentially appending keyword to list</span>
<span class="sd">    @param kList: list of keywords.</span>
<span class="sd">    @type kList:</span>
<span class="sd">    @param newK:</span>
<span class="sd">    @type newK:</span>
<span class="sd">    @return:</span>
<span class="sd">    @rtype:</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="getwordfrequency"><a class="viewcode-back" href="../functionsv1.html#common_functions.getwordfrequency">[docs]</a><span class="k">def</span> <span class="nf">getwordfrequency</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">file_text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: determines frequency of the given word in the file&#39;s text</span>
<span class="sd">    @param word: word to find freq. of</span>
<span class="sd">    @type word: string</span>
<span class="sd">    @param file_text: text of entire file</span>
<span class="sd">    @type file_text: list of string</span>
<span class="sd">    @return: frequency</span>
<span class="sd">    @rtype: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Only populate longlongfiletext once, it is very inefficient the way it is now.</span>
    <span class="n">longlongfiletext</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">stringlisttolonglongstring</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">longlongfiletext</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">longlongfiletext</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span></div>


<div class="viewcode-block" id="getregulatorydoctext"><a class="viewcode-back" href="../functionsv1.html#common_functions.getregulatorydoctext">[docs]</a><span class="k">def</span> <span class="nf">getregulatorydoctext</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Looks in the RegulatoryDocuments folder for the file with the given file name and return&#39;s its text as a list of string</span>
<span class="sd">    @param filename: name of file to open</span>
<span class="sd">    @type filename: string</span>
<span class="sd">    @return: list of string containing text of file</span>
<span class="sd">    @rtype: List[string]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;opening regulatory document&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">REGULATOR_FOLDER</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="n">FileStorage</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

        <span class="n">reg_text</span> <span class="o">=</span> <span class="n">extractpdftext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">RegDoc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="ow">and</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;could not access regulatory document&quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>

    <span class="c1"># print(reg_text)</span>
    <span class="k">return</span> <span class="n">cleantext</span><span class="p">(</span><span class="n">reg_text</span><span class="p">)</span></div>


<div class="viewcode-block" id="kwhighestfrequencies"><a class="viewcode-back" href="../functionsv1.html#common_functions.kwhighestfrequencies">[docs]</a><span class="k">def</span> <span class="nf">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Returns the top 10 most frequent Keywords in the user&#39;s uploaded file</span>
<span class="sd">    @param keyword_list: lis tof file&#39;s Keywords</span>
<span class="sd">    @type keyword_list: list of keywords</span>
<span class="sd">    @return: topkeywords</span>
<span class="sd">    @rtype: list of highest frequency Keywords</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">keyword_list</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
    <span class="n">topkeywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">topKeywordfreqs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># This loop finds the 10 most common keywords in the keyword_list</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">topkeywordfreq</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">frequency</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span><span class="p">)</span>
        <span class="n">topKeywordfreqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeywordfreq</span><span class="p">)</span>

        <span class="n">topkeyword</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">kw</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">kw</span><span class="o">.</span><span class="n">frequency</span> <span class="o">==</span> <span class="n">topkeywordfreq</span><span class="p">)</span>
        <span class="n">topkeywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeyword</span><span class="p">)</span>

        <span class="n">kwlist</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">word</span> <span class="o">!=</span> <span class="n">topkeyword</span><span class="o">.</span><span class="n">word</span><span class="p">]</span> <span class="c1"># removes the previously added item so it does not get chosen again</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">topkeywords</span></div>

<div class="viewcode-block" id="kwhighestkeyscores"><a class="viewcode-back" href="../functionsv1.html#common_functions.kwhighestkeyscores">[docs]</a><span class="k">def</span> <span class="nf">kwhighestkeyscores</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Returnst the twn Keywords with the highest Keyword scores</span>
<span class="sd">    @param keyword_list:</span>
<span class="sd">    @type keyword_list: list of keywords</span>
<span class="sd">    @return: topkeywords</span>
<span class="sd">    @rtype: list of top Keywords</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">keyword_list</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
    <span class="n">topkeywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">topKeywordscores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># This loop finds the 10 highest keyword scores in the keyword_list</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">topkeywordscore</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keywordscore</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span><span class="p">)</span>
        <span class="n">topKeywordscores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeywordscore</span><span class="p">)</span>

        <span class="n">topkeyword</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">kw</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">kw</span><span class="o">.</span><span class="n">keywordscore</span> <span class="o">==</span> <span class="n">topkeywordscore</span><span class="p">)</span>
        <span class="n">topkeywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeyword</span><span class="p">)</span>

        <span class="n">kwlist</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">word</span> <span class="o">!=</span> <span class="n">topkeyword</span><span class="o">.</span><span class="n">word</span><span class="p">]</span> <span class="c1"># removes the previously added item so it does not get chosen again</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">topkeywords</span></div>


<div class="viewcode-block" id="plotkeywordsalience"><a class="viewcode-back" href="../functionsv1.html#common_functions.plotkeywordsalience">[docs]</a><span class="k">def</span> <span class="nf">plotkeywordsalience</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">,</span> <span class="n">keyword_list2</span><span class="p">,</span> <span class="n">doc1name</span><span class="o">=</span><span class="s1">&#39;doc1&#39;</span><span class="p">,</span> <span class="n">doc2name</span> <span class="o">=</span> <span class="s1">&#39;doc2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: plots salience of most frequently used keywords. Pulls KWs from list1, compares against list2</span>
<span class="sd">    @param keyword_list1:</span>
<span class="sd">    @type keyword_list1: KeywordList</span>
<span class="sd">    @param keyword_list2:</span>
<span class="sd">    @type keyword_list2: KeywordList</span>
<span class="sd">    @param doc1name: name of first document</span>
<span class="sd">    @type doc1name: string</span>
<span class="sd">    @param doc2name: name of second document</span>
<span class="sd">    @type doc2name: string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Clearing previous graph just to be safe</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">kwlist1</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">)</span>
    <span class="n">kwlist2</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list2</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">)):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">my_xtick</span> <span class="o">=</span> <span class="n">word</span>
                <span class="n">my_xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_xtick</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NO COMMON KEYWORDS TO PLOT&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topsalience.png&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">))</span>
    <span class="c1"># colors = np.random.rand(d)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;User doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc1name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulatory doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc2name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="c1"># pyplot.scatter(x - w, y, color=&#39;blue&#39;, label=&#39;doc1&#39;)</span>
    <span class="c1"># pyplot.scatter(x, p, color=&#39;r&#39;, label=&#39;doc2&#39;)</span>
    <span class="c1"># pyplot.plot(x,y)</span>
    <span class="c1"># pyplot.plot(x - w, y, color=&#39;blue&#39;, label=&#39;doc1&#39;)</span>
    <span class="c1"># pyplot.plot(x, p, color=&#39;r&#39;, label=&#39;doc2&#39;)</span>
    <span class="c1"># pyplot.scatter(x,y,c=colors)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_xticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Salience of Most Common Keywords In File&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Keywords (in order of frequency in uploaded document)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Salience&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topsalience.png&#39;</span><span class="p">)</span></div>
    <span class="c1"># pyplot.show()</span>


<div class="viewcode-block" id="plotkeywordscores"><a class="viewcode-back" href="../functionsv1.html#common_functions.plotkeywordscores">[docs]</a><span class="k">def</span> <span class="nf">plotkeywordscores</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">,</span> <span class="n">keyword_list2</span><span class="p">,</span> <span class="n">doc1name</span><span class="o">=</span><span class="s1">&#39;doc1&#39;</span><span class="p">,</span> <span class="n">doc2name</span> <span class="o">=</span> <span class="s1">&#39;doc2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: plots keyword score of most frequently used keywords. Pulls KWs from list1, compares against list2</span>
<span class="sd">    @param keyword_list1:</span>
<span class="sd">    @type keyword_list1: KeywordList</span>
<span class="sd">    @param keyword_list2:</span>
<span class="sd">    @type keyword_list2: KeywordList</span>
<span class="sd">    @param doc1name: name of first document</span>
<span class="sd">    @type doc1name: string</span>
<span class="sd">    @param doc2name: name of second document</span>
<span class="sd">    @type doc2name: string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Clearing previous graph just to be safe</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="c1">#kwlist1 = common_functions.kwhighestfrequencies(keyword_list1)</span>
    <span class="c1">#kwlist2 = common_functions.kwhighestfrequencies(keyword_list2)</span>
    <span class="n">kwlist1</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestkeyscores</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">)</span>
    <span class="n">kwlist2</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestkeyscores</span><span class="p">(</span><span class="n">keyword_list2</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">)):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">my_xtick</span> <span class="o">=</span> <span class="n">word</span>
                <span class="n">my_xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_xtick</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keywordscore</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">keywordscore</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NO COMMON KEYWORDS TO PLOT&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordscores.png&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">))</span>
    <span class="c1"># colors = np.random.rand(d)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;User doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc1name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulatory doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc2name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="c1"># pyplot.scatter(x - w, y, color=&#39;blue&#39;, label=&#39;doc1&#39;)</span>
    <span class="c1"># pyplot.scatter(x, p, color=&#39;r&#39;, label=&#39;doc2&#39;)</span>
    <span class="c1"># pyplot.plot(x,y)</span>
    <span class="c1"># pyplot.plot(x - w, y, color=&#39;blue&#39;, label=&#39;doc1&#39;)</span>
    <span class="c1"># pyplot.plot(x, p, color=&#39;r&#39;, label=&#39;doc2&#39;)</span>
    <span class="c1"># pyplot.scatter(x,y,c=colors)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_xticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Keyword Score of Most Common Keywords In File&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Keywords (in order of keyword score in uploaded document)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Keyword Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordscores.png&#39;</span><span class="p">)</span></div>
    <span class="c1"># pyplot.show()</span>

<div class="viewcode-block" id="plotkeywordfrequency"><a class="viewcode-back" href="../functionsv1.html#common_functions.plotkeywordfrequency">[docs]</a><span class="k">def</span> <span class="nf">plotkeywordfrequency</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">,</span> <span class="n">keyword_list2</span><span class="p">,</span> <span class="n">doc1name</span><span class="o">=</span><span class="s1">&#39;doc1&#39;</span><span class="p">,</span> <span class="n">doc2name</span> <span class="o">=</span> <span class="s1">&#39;doc2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: plots keyword score of most frequently used keywords. Pulls KWs from list1, compares against list2</span>
<span class="sd">    @param keyword_list1:</span>
<span class="sd">    @type keyword_list1: KeywordList</span>
<span class="sd">    @param keyword_list2:</span>
<span class="sd">    @type keyword_list2: KeywordList</span>
<span class="sd">    @param doc1name: name of first document</span>
<span class="sd">    @type doc1name: string</span>
<span class="sd">    @param doc2name: name of second document</span>
<span class="sd">    @type doc2name: string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Clearing previous graph just to be safe</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">kwlist1</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">)</span>
    <span class="n">kwlist2</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list2</span><span class="p">)</span>
    <span class="c1">#kwlist1 = common_functions.kwhighestkeyscores(keyword_list1)</span>
    <span class="c1">#kwlist2 = common_functions.kwhighestkeyscores(keyword_list2)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">)):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">my_xtick</span> <span class="o">=</span> <span class="n">word</span>
                <span class="n">my_xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_xtick</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NO COMMON KEYWORDS TO PLOT&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topwordfrequency.png&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">))</span>
    <span class="c1"># colors = np.random.rand(d)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;User doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc1name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulatory doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc2name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="c1"># pyplot.scatter(x - w, y, color=&#39;blue&#39;, label=&#39;doc1&#39;)</span>
    <span class="c1"># pyplot.scatter(x, p, color=&#39;r&#39;, label=&#39;doc2&#39;)</span>
    <span class="c1"># pyplot.plot(x,y)</span>
    <span class="c1"># pyplot.plot(x - w, y, color=&#39;blue&#39;, label=&#39;doc1&#39;)</span>
    <span class="c1"># pyplot.plot(x, p, color=&#39;r&#39;, label=&#39;doc2&#39;)</span>
    <span class="c1"># pyplot.scatter(x,y,c=colors)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_xticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Keyword Frequencies of Most Common Keywords In File&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Keywords (in order of keyword score in uploaded document)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordfrequency.png&#39;</span><span class="p">)</span></div>
    <span class="c1"># pyplot.show()</span>




</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Linguistic Analyzer 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Paul Brown, Tyler Blanton.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.4.
    </div>
  </body>
</html>