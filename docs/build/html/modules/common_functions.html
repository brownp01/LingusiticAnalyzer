
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>common_functions &#8212; Linguistic Analyzer 2.0 documentation</title>
    <link rel="stylesheet" href="../static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Linguistic Analyzer 2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for common_functions</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">werkzeug.utils</span> <span class="k">import</span> <span class="n">secure_filename</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">functionsv1</span> <span class="k">import</span> <span class="n">common_functions</span>
<span class="kn">from</span> <span class="nn">functionsv1</span> <span class="k">import</span> <span class="n">analyze_functions</span>
<span class="kn">from</span> <span class="nn">Keyword</span> <span class="k">import</span> <span class="n">Keyword</span>
<span class="kn">from</span> <span class="nn">werkzeug.datastructures</span> <span class="k">import</span> <span class="n">FileStorage</span>
<span class="kn">import</span> <span class="nn">docx</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">pdfminer.pdfinterp</span> <span class="k">import</span> <span class="n">PDFResourceManager</span><span class="p">,</span> <span class="n">PDFPageInterpreter</span>
<span class="kn">from</span> <span class="nn">pdfminer.converter</span> <span class="k">import</span> <span class="n">TextConverter</span>
<span class="kn">from</span> <span class="nn">pdfminer.layout</span> <span class="k">import</span> <span class="n">LAParams</span>
<span class="kn">from</span> <span class="nn">pdfminer.pdfpage</span> <span class="k">import</span> <span class="n">PDFPage</span>
<span class="kn">import</span> <span class="nn">Keyword</span>
<span class="kn">from</span> <span class="nn">KeywordList</span> <span class="k">import</span> <span class="n">KeywordList</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;agg&#39;</span><span class="p">,</span><span class="n">warn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1">#import applicationconfig</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">operator</span>


<span class="n">DOWNLOAD_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;downloads/&#39;</span>
<span class="n">REGULATOR_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;RegulatoryDocuments/&#39;</span>
<span class="n">DOCUMENTS_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;Documents/&#39;</span>
<span class="n">VIEWS_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;views/&#39;</span>


<div class="viewcode-block" id="homeCount"><a class="viewcode-back" href="../functionsv1.html#common_functions.homeCount">[docs]</a><span class="k">def</span> <span class="nf">homeCount</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes variables for logging session</span>


<span class="sd">        :return: void</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">returnVal</span> <span class="o">=</span> <span class="n">homeCount</span><span class="o">.</span><span class="n">counter</span>
    <span class="n">homeCount</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">returnVal</span></div>


<span class="n">homeCount</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>


<span class="c1"># going to handle all the mess that is in application.py</span>
<div class="viewcode-block" id="interpretfile"><a class="viewcode-back" href="../functionsv1.html#common_functions.interpretfile">[docs]</a><span class="k">def</span> <span class="nf">interpretfile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localuploadfolder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Function that handles uploaded user document. The following occurs:</span>

<span class="sd">    1. Extracts text from a pdf file with :func:`extractpdftext`.</span>
<span class="sd">    2. Identifies keywords with :func:`analyze_functions.identifykeywords`.</span>
<span class="sd">    3. Calculates various scores for each keyword with :func:`analyze_functions.calculatescores` and</span>
<span class="sd">       :func:`KeywordList.KeywordList.calculateavgscores`.</span>
<span class="sd">    4. Exports keyword information to a *.txt* file via :func:`outputkeywordtotext`.</span>
<span class="sd">    5. Determines total word count for a *file*. The value is stored in the variable *wordcount*</span>


<span class="sd">    :param fileStorage file: file to be interpreted</span>
<span class="sd">    :param str localuploadfolder: Place to temporary store file so it can be read from</span>
<span class="sd">    :return: list of file&#39;s Keywords, wordcount</span>
<span class="sd">    :rtype: KeywordList, int</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># -----------GRABBING TEXT FROM FILE----------- #</span>
    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
        <span class="n">file_text</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">extractpdftext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localuploadfolder</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;docx&#39;</span><span class="p">:</span>
        <span class="n">file_text</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">extractmicrosoftdocxtext</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="c1"># common_functions.printStringList(file_text)</span>

    <span class="c1"># -----------IDENTIFYING KEYWORDS----------- #</span>
    <span class="n">keyword_list</span> <span class="o">=</span> <span class="n">analyze_functions</span><span class="o">.</span><span class="n">identifykeywords</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span>

    <span class="c1"># -----------CALCULATING VARIOUS SCORES FOR EACH KEYWORD----------- #</span>
    <span class="n">analyze_functions</span><span class="o">.</span><span class="n">calculatescores</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">,</span> <span class="n">file_text</span><span class="p">)</span>
    <span class="n">keyword_list</span><span class="o">.</span><span class="n">calculateavgscores</span><span class="p">()</span>

    <span class="c1"># -----------PUTTING KEYWORDS IN FILE----------- #</span>
    <span class="n">common_functions</span><span class="o">.</span><span class="n">outputkeywordtotext</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">)</span>


    <span class="n">wordcount</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">file_text</span><span class="p">:</span>
        <span class="n">wordcount</span> <span class="o">=</span> <span class="n">wordcount</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">keyword_list</span><span class="p">,</span> <span class="n">wordcount</span><span class="p">]</span></div>


<div class="viewcode-block" id="interpretexistingfile"><a class="viewcode-back" href="../functionsv1.html#common_functions.interpretexistingfile">[docs]</a><span class="k">def</span> <span class="nf">interpretexistingfile</span><span class="p">(</span><span class="n">regfilename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Function that handles a newly uploaded regulatory doc or an existing regulatory document. The following occurs:</span>

<span class="sd">    1. Checks *regfilename* to determine if it&#39;s a .pdf. If it&#39;s a .pdf, then that means that this is the first time</span>
<span class="sd">       a regulatory document has been published to the app. Analysis of the document needs to occur.</span>

<span class="sd">       - Extracts text from a pdf file with :func:`getregulatorydoctext`.</span>
<span class="sd">       - Identifies keywords with :func:`analyze_functions.identifykeywords`.</span>
<span class="sd">       - Calculates various scores for each keyword with :func:`analyze_functions.calculatescores` and</span>
<span class="sd">         :func:`KeywordList.KeywordList.calculateavgscores`.</span>
<span class="sd">       - The file extension is changed from *.pdf* to *.txt*. This is done so that the existing filename with extension can</span>
<span class="sd">         be used when exporting information to *.txt* file.</span>
<span class="sd">       - Exports keyword information to a *.txt* file via :func:`outputkeywordtotext`.</span>
<span class="sd">       - &#39;views/index.html&#39; is edited to include the new regulatory document file path for future selection on the app</span>
<span class="sd">         home page. The file path points to the *.txt* version of the document so analysis does not occur again.</span>

<span class="sd">    2. If the *regfilename* is not a *pdf* file, then it&#39;s a *txt* file. Analysis of the file does not need to occur</span>
<span class="sd">       since it was previously done.</span>

<span class="sd">       - The keywords with associated information are extracted from the *txt* file via :func:`extractkeywordfromtxt`.</span>


<span class="sd">    :param str regfilename: name of regulatory file</span>
<span class="sd">    :return: Keyword list of regulatory document.</span>
<span class="sd">    :rtype: KeywordList</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">regfilename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
        <span class="n">reg_text</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">getregulatorydoctext</span><span class="p">(</span><span class="n">regfilename</span><span class="p">)</span>
        <span class="n">reg_keyword_list</span> <span class="o">=</span> <span class="n">analyze_functions</span><span class="o">.</span><span class="n">identifykeywords</span><span class="p">(</span><span class="n">reg_text</span><span class="p">)</span>
        <span class="n">analyze_functions</span><span class="o">.</span><span class="n">calculatescores</span><span class="p">(</span><span class="n">reg_keyword_list</span><span class="p">,</span> <span class="n">reg_text</span><span class="p">)</span>
        <span class="n">reg_keyword_list</span><span class="o">.</span><span class="n">calculateavgscores</span><span class="p">()</span>
        <span class="n">regfilenameTXT</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">changefileextension</span><span class="p">(</span><span class="n">regfilename</span><span class="p">)</span>
        <span class="n">common_functions</span><span class="o">.</span><span class="n">outputkeywordtotext</span><span class="p">(</span><span class="n">reg_keyword_list</span><span class="p">,</span> <span class="n">REGULATOR_FOLDER</span> <span class="o">+</span> <span class="n">regfilenameTXT</span><span class="p">)</span>

        <span class="c1">#------- Change filename extension for reg doc path in &#39;index.html&#39; to .txt after initial PDF analysis -------#</span>

        <span class="n">fhtml</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;views/index.html&#39;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">fhtml</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">newhtml</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;option value=&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">regfilename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;&lt;option value=&#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">regfilenameTXT</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
        <span class="n">fhtml</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">newindexhtml</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;views/index.html&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">newindexhtml</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">newhtml</span><span class="p">)</span>
        <span class="n">newindexhtml</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">reg_keyword_list</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">extractkeywordfromtxt</span><span class="p">(</span><span class="n">regfilename</span><span class="p">)</span>

    <span class="n">common_functions</span><span class="o">.</span><span class="n">outputkeywordtotext</span><span class="p">(</span><span class="n">reg_keyword_list</span><span class="p">,</span> <span class="s1">&#39;Documents/Reg_Keywords.txt&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reg_keyword_list</span></div>


<div class="viewcode-block" id="changefileextension"><a class="viewcode-back" href="../functionsv1.html#common_functions.changefileextension">[docs]</a><span class="k">def</span> <span class="nf">changefileextension</span><span class="p">(</span><span class="n">regfilename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Changes the file name string from *.pdf* to *.txt*.</span>


<span class="sd">    :param str regfilename: name of regulatory file</span>
<span class="sd">    :return: string with *.txt* file extension</span>
<span class="sd">    :rtype: str</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">regfilename</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">regfilename</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="n">size</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;t&quot;</span>
    <span class="n">temp</span><span class="p">[</span><span class="n">size</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
    <span class="n">temp</span><span class="p">[</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;t&quot;</span>
    <span class="n">regfilenameTXT</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">regfilenameTXT</span></div>


<div class="viewcode-block" id="getscorepage"><a class="viewcode-back" href="../functionsv1.html#common_functions.getscorepage">[docs]</a><span class="k">def</span> <span class="nf">getscorepage</span><span class="p">(</span><span class="n">kw_list</span><span class="p">,</span> <span class="n">reg_kw_list</span><span class="p">,</span> <span class="n">userdocwordcount</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">regfilename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Returns &#39;views/score_response.html&#39; page that is populated with proper calculated Keyword, Comparison,</span>
<span class="sd">    and Yule&#39;s scores.</span>


<span class="sd">    :param KeywordList kw_list: list of user document&#39;s Keyword objects</span>
<span class="sd">    :param KeywordList reg_kw_list: list of regulatory document&#39;s Keywords</span>
<span class="sd">    :param int userdocwordcount: word count of user document</span>
<span class="sd">    :param str filename: user document&#39;s file name</span>
<span class="sd">    :param str regfilename: regulatory document&#39;s file name</span>
<span class="sd">    :return: html page with scores displayed</span>
<span class="sd">    :rtype: str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">html_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Begin score page response...&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Documents/Analytics.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">html_str</span> <span class="o">=</span> <span class="n">html_str</span> <span class="o">+</span> <span class="s1">&#39;&lt;p&gt;&#39;</span> <span class="o">+</span> <span class="n">l</span> <span class="o">+</span> <span class="s1">&#39;&lt;/p&gt;&#39;</span>


    <span class="n">numofkwoccurences</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">:</span>
        <span class="n">numofkwoccurences</span> <span class="o">+=</span> <span class="n">kw</span><span class="o">.</span><span class="n">frequency</span>



    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;views/score_response.html&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">returnhtml</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--KEYWORD_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getavgkeywordscore</span><span class="p">()))</span><span class="o">.</span> \
        <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--YULESK_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getyuleskscore</span><span class="p">()))</span>\
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--DOCUMENT_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getdocumentscore</span><span class="p">()))</span>\
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--COMPARISON_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">analyze_functions</span><span class="o">.</span><span class="n">calculatecomparisonscore</span><span class="p">(</span><span class="n">kw_list</span><span class="p">,</span> <span class="n">reg_kw_list</span><span class="p">)))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#-USER-DOC-NAME-#&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#-REG-DOC-NAME-#&#39;</span><span class="p">,</span> <span class="n">regfilename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--REG_YULESK_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">getyuleskscore</span><span class="p">()))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--YULESI_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">getyulesiscore</span><span class="p">()))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--REG_YULESI_SCORE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">getyulesiscore</span><span class="p">()))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;ANALYTICS LOG - last 100 lines:&lt;/p&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;ANALYTICS LOG - last 100 lines:&lt;/p&gt;&#39;</span> <span class="o">+</span> <span class="n">html_str</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--USER-DOC-KEYWORD-NUM--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">)))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--REG-DOC-KEYWORD-NUM--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">)))</span> \
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#--KEYWORDS-COMPRISE--#&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">numofkwoccurences</span><span class="o">/</span><span class="n">userdocwordcount</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Score page response complete.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">returnhtml</span></div>


<div class="viewcode-block" id="geterrorpage"><a class="viewcode-back" href="../functionsv1.html#common_functions.geterrorpage">[docs]</a><span class="k">def</span> <span class="nf">geterrorpage</span><span class="p">(</span><span class="n">errtext</span><span class="o">=</span><span class="s2">&quot;Unknown Error&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Populates error message with proper response and returns html</span>


<span class="sd">    :param str errtext: text of error</span>
<span class="sd">    :return: html page with error displayed</span>
<span class="sd">    :rtype: str</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">common_functions</span><span class="o">.</span><span class="n">writeToConfig</span><span class="p">(</span><span class="s1">&#39;NEW_DOC_FLAG&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>

    <span class="c1"># Returns error page</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;views/invalid_upload.html&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">returnhtml</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;##ERROR##&#39;</span><span class="p">,</span> <span class="n">errtext</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">returnhtml</span></div>


<div class="viewcode-block" id="extractpdftext"><a class="viewcode-back" href="../functionsv1.html#common_functions.extractpdftext">[docs]</a><span class="k">def</span> <span class="nf">extractpdftext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">testdownload_folder</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">RegDoc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Extracts text from PDF document referenced in the given file argument using the :mod:`PDFMiner` python package.</span>

<span class="sd">    The first part of the code assigns a &quot;chunk&quot; size via the value *NUM_SEND_CHARS* set in /applicationconfig.json.</span>
<span class="sd">    *chunk_size* is designated to break up a long string of text into a list of strings, if needed. The default setting</span>
<span class="sd">    for this allows for a single string of text.</span>

<span class="sd">    Before starting the PDF text extraction, logging is disabled due to the amount of statements PDFMiner produces in the</span>
<span class="sd">    log.</span>


<span class="sd">    :param fileStorage file: the PDF file to extract text from</span>
<span class="sd">    :param str testdownload_folder: specific download folder if necessary</span>
<span class="sd">    :param bool RegDoc: flag specifying whether this is a user doc or a regulatory doc</span>
<span class="sd">    :return: file&#39;s text</span>
<span class="sd">    :rtype: List[str]</span>
<span class="sd">    :raises: FileNotFoundError</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">((</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;applicationconfig.json&#39;</span><span class="p">)))</span>

    <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;NUM_SEND_CHARS&#39;</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># -- This is for testing, do not remove -- #</span>
        <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">RegDoc</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">DOWNLOAD_FOLDER</span>
            <span class="n">savefile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localdownload_folder</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">testdownload_folder</span>

        <span class="c1"># PdfMiner writes an insane amount of logging statements (one per parsed word, it seems).</span>
        <span class="c1"># Remove the below line if you would like to see them.</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="c1"># ----------This is the PDFMiner.six PDF Reader ----------#</span>
        <span class="n">pages</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">pagenums</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pagenums</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">PDFResourceManager</span><span class="p">()</span>
        <span class="n">converter</span> <span class="o">=</span> <span class="n">TextConverter</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="n">LAParams</span><span class="p">())</span>
        <span class="n">interpreter</span> <span class="o">=</span> <span class="n">PDFPageInterpreter</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">converter</span><span class="p">)</span>

        <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">localdownload_folder</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">PDFPage</span><span class="o">.</span><span class="n">get_pages</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">pagenums</span><span class="p">):</span>
            <span class="n">interpreter</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
        <span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">converter</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>        <span class="c1"># Worry - An incredibly long string may crash our application</span>
        <span class="n">output</span><span class="o">.</span><span class="n">close</span>
        <span class="c1"># --------End of PDFMiner reading --------#</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>  <span class="c1"># This re-enables logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PDF file processed&quot;</span><span class="p">)</span>

        <span class="n">file_text</span> <span class="o">=</span> <span class="n">longstringtostringlist</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>  <span class="c1"># Converting long string to list of strings of size</span>


    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">fnfe</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">fnfe</span><span class="o">.</span><span class="n">strerror</span><span class="p">)</span>
        <span class="c1"># print(fnfe.strerror)</span>
    <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">RegDoc</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>       <span class="c1"># If this is not a test, remove file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">localdownload_folder</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>  <span class="c1"># Removes created file from directory.</span>
    <span class="k">return</span> <span class="n">cleantext</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span></div>


<div class="viewcode-block" id="extractmicrosoftdocxtext"><a class="viewcode-back" href="../functionsv1.html#common_functions.extractmicrosoftdocxtext">[docs]</a><span class="k">def</span> <span class="nf">extractmicrosoftdocxtext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">testdownload_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Extracts text from any *.docx* document and returns it.</span>


<span class="sd">    :param fileStorage file: the file to save</span>
<span class="sd">    :param str testdownload_folder: Specific download folder is necessary</span>
<span class="sd">    :return: file&#39;s text</span>
<span class="sd">    :rtype: List[str]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">DOWNLOAD_FOLDER</span>
            <span class="n">savefile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">localdownload_folder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">localdownload_folder</span> <span class="o">=</span> <span class="n">testdownload_folder</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">(</span><span class="n">localdownload_folder</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">para</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">para</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">file_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">para</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">fnfe</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;**-- ERROR: unable to find file file --**&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fnfe</span><span class="o">.</span><span class="n">strerror</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testdownload_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># Removes created file from directory.</span>

    <span class="n">file_text</span> <span class="o">=</span> <span class="n">splitintosize</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cleantext</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span></div>


<div class="viewcode-block" id="splitintosize"><a class="viewcode-back" href="../functionsv1.html#common_functions.splitintosize">[docs]</a><span class="k">def</span> <span class="nf">splitintosize</span><span class="p">(</span><span class="n">file_text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This function splits a list of keywords of any length into a list of keywords each of length specified by</span>
<span class="sd">    NUM_SEND_CHARS in &#39;/applicationconfig.json&#39;</span>


<span class="sd">    :param list file_text: list of document&#39;s words</span>
<span class="sd">    :return: file_text</span>
<span class="sd">    :rtype: List[str]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">stringlisttolonglongstring</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">((</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;applicationconfig.json&#39;</span><span class="p">)))</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;NUM_SEND_CHARS&#39;</span><span class="p">])</span>
    <span class="n">file_text</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">file_text</span></div>


<div class="viewcode-block" id="savefile"><a class="viewcode-back" href="../functionsv1.html#common_functions.savefile">[docs]</a><span class="k">def</span> <span class="nf">savefile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">download_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Save&#39;s given file to &#39;/Downloads&#39; folder.</span>


<span class="sd">    :param fileStorage file: the file to save</span>
<span class="sd">    :param str download_folder: specific download folder if necessary</span>
<span class="sd">    :return: void</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># -- This is for testing, do not remove -- #</span>
    <span class="k">if</span><span class="p">(</span><span class="n">download_folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">DOWNLOAD_FOLDER</span> <span class="o">=</span> <span class="n">download_folder</span>

    <span class="c1"># filename = secure_filename(file.filename)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;saving file &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>  <span class="c1"># saves uploaded files</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot; saved&#39;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;opening file &quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>  <span class="c1"># Logging</span></div>


<div class="viewcode-block" id="outputkeywordtotext"><a class="viewcode-back" href="../functionsv1.html#common_functions.outputkeywordtotext">[docs]</a><span class="k">def</span> <span class="nf">outputkeywordtotext</span><span class="p">(</span><span class="n">keylist</span><span class="p">,</span> <span class="n">download_folder</span> <span class="o">=</span> <span class="s1">&#39;Documents/Keywords.txt&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This function will write Keywords and associated data from an analyzed document to a *.txt* file.</span>

<span class="sd">    - The first line written to the file is the Yule&#39;s K, Yule&#39;s I and average keyscore of a :class:`KeywordList` object.</span>
<span class="sd">    - The second and following lines include the Keyword, Salience score, Frequency of keyword, and the Keyword score from</span>
<span class="sd">      the :class:`Keyword` object.</span>
<span class="sd">    - An **Exception** will raise if the output of Keywords to a *.txt* file does not fully complete. This is an issue that</span>
<span class="sd">      occurs in the AWS Beanstalk environment. Running the app on a local machine should not throw the Exception, based</span>
<span class="sd">      on testing.</span>


<span class="sd">    :param KeywordList keylist: list of document keywords</span>
<span class="sd">    :param str download_folder: location to save the *.txt* file.</span>
<span class="sd">    :return: void</span>
<span class="sd">    :raises: Exception</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Outputting keywords to .txt...&quot;</span><span class="p">)</span>

        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">yulesK</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">yuleskscore</span>
        <span class="n">yulesI</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">yulesiscore</span>
        <span class="n">avgkeyscore</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">avgkeywordscore</span>

        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">yulesK</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">yulesI</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">avgkeyscore</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># ------alphabetical order------- #</span>
        <span class="c1"># TODO: Put in frequency order</span>
        <span class="n">sortedkeywords</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keylist</span><span class="o">.</span><span class="n">uniquekeywords</span><span class="p">):</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
            <span class="n">sal</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span>
            <span class="n">keyscore</span> <span class="o">=</span> <span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keywordscore</span>

            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">word</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">keyscore</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Keyword .txt output complete.&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;*** Output keywords failed: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keylist</span><span class="o">.</span><span class="n">list</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; keywords outputted ***&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="extractkeywordfromtxt"><a class="viewcode-back" href="../functionsv1.html#common_functions.extractkeywordfromtxt">[docs]</a><span class="k">def</span> <span class="nf">extractkeywordfromtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This function will extract existing keyword information from *.txt file* and place it into the :class:`KeywordList`</span>
<span class="sd">    object.</span>

<span class="sd">    - This function will read in the first line of an existing *.txt* file and place the Yule&#39;s K, Yule&#39;s I, and average</span>
<span class="sd">      keyword score into a :class:`KeywordList` object.</span>
<span class="sd">    - For the second and remaining lines, the Keyword, Salience score, Frequency of keyword, and Keyword score are placed</span>
<span class="sd">      into a :class:`Keyword` object, and then inserted in a :class:`KeywordList` object via the</span>
<span class="sd">      :func:`KeywordList.KeywordList.insertkeyword` function.</span>
<span class="sd">    - An **Exception** will raise if the extraction of keywords from a *.txt* file does not fully complete. This is an</span>
<span class="sd">      issue that occurs in the AWS Beanstalk environment. Running the app on a local machine should not throw the Exception,</span>
<span class="sd">      based on testing.</span>


<span class="sd">    :param str file: location of .txt file</span>
<span class="sd">    :return: keyword list in file</span>
<span class="sd">    :rtype: KeywordList</span>
<span class="sd">    :raises: Exception</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">keyword_list</span> <span class="o">=</span> <span class="n">KeywordList</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">REGULATOR_FOLDER</span><span class="o">+</span><span class="n">filename</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting keyword info from &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">line_list</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">yulesk</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">yulesi</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">avgscore</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">keyword_list</span><span class="o">.</span><span class="n">yuleskscore</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">yulesk</span><span class="p">))</span>
        <span class="n">keyword_list</span><span class="o">.</span><span class="n">yulesiscore</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">yulesi</span><span class="p">))</span>
        <span class="n">keyword_list</span><span class="o">.</span><span class="n">avgkeywordscore</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">avgscore</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">sal</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">keyscore</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>

            <span class="c1"># TODO modify input to Keyword Object to fit overall needs</span>
            <span class="n">newKeyword</span> <span class="o">=</span> <span class="n">Keyword</span><span class="o">.</span><span class="n">Keyword</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">sal</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">keyscore</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))))</span>
            <span class="n">keyword_list</span><span class="o">.</span><span class="n">insertkeyword</span><span class="p">(</span><span class="n">newKeyword</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;keyword info extraction complete.&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;*** Keyword info extraction failed(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">keyword_list</span><span class="o">.</span><span class="n">uniquekeywords</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; uploaded). ***&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">keyword_list</span></div>


<div class="viewcode-block" id="cleantext"><a class="viewcode-back" href="../functionsv1.html#common_functions.cleantext">[docs]</a><span class="k">def</span> <span class="nf">cleantext</span><span class="p">(</span><span class="n">text_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Removes special characters from text.</span>

<span class="sd">    :param List[str] text_list: a text string </span>
<span class="sd">    :return: text_list with no special chars</span>
<span class="sd">    :rtype: List[str]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Cleaning text of special characters...&quot;</span><span class="p">)</span>
    <span class="n">printable</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">text_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">,</span> <span class="n">text_list</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Clean text complete.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">text_list</span></div>

<div class="viewcode-block" id="printStringList"><a class="viewcode-back" href="../functionsv1.html#common_functions.printStringList">[docs]</a><span class="k">def</span> <span class="nf">printStringList</span><span class="p">(</span><span class="n">textList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Helper function that prints a list of strings</span>


<span class="sd">    :param List[str] textList: a text string</span>
<span class="sd">    :return: void</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">textList</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">textList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>

<div class="viewcode-block" id="longstringtostringlist"><a class="viewcode-back" href="../functionsv1.html#common_functions.longstringtostringlist">[docs]</a><span class="k">def</span> <span class="nf">longstringtostringlist</span><span class="p">(</span><span class="n">longstring</span><span class="p">,</span> <span class="n">strsize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: This functions splits a long string *longstring* into strings of size *strsize* and returns a list of those</span>
<span class="sd">    strings.</span>


<span class="sd">    :param str longstring: text of file</span>
<span class="sd">    :param int strsize: requested length of each string in created list of strings</span>
<span class="sd">    :return: return_list</span>
<span class="sd">    :rtype: List[str]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">return_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">longstring</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">strsize</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">longstring</span><span class="p">),</span> <span class="n">strsize</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="stringlisttolonglongstring"><a class="viewcode-back" href="../functionsv1.html#common_functions.stringlisttolonglongstring">[docs]</a><span class="k">def</span> <span class="nf">stringlisttolonglongstring</span><span class="p">(</span><span class="n">string_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Helper function to turn a list of strings into one long long string.</span>

<span class="sd">    :param List[str] string_list: a string of text</span>
<span class="sd">    :return: file&#39;s text</span>
<span class="sd">    :rtype: long str</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">long_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">string_list</span><span class="p">)):</span>
        <span class="n">long_string</span> <span class="o">+=</span> <span class="n">string_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">long_string</span></div>


<div class="viewcode-block" id="createkeywordfromgoogleapientity"><a class="viewcode-back" href="../functionsv1.html#common_functions.createkeywordfromgoogleapientity">[docs]</a><span class="k">def</span> <span class="nf">createkeywordfromgoogleapientity</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">file_text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Creates a Keyword from a single entity that is returned by the google NLP API.</span>

<span class="sd">    - The &#39;name&#39; or Keyword, Type of keyword, Salience score, and Frequency of the keyword is inputted in the</span>
<span class="sd">      :class:`Keyword` object. A default value of *0* is used for the keyword score. Keyword score is determined further</span>
<span class="sd">      on in the app.</span>
<span class="sd">    - The frequency of a keyword is found by using the :func:`getwordfrequency` function.</span>


<span class="sd">    :param dict entity: Google API response entity object</span>
<span class="sd">    :param List[str] file_text: entire text of file</span>
<span class="sd">    :return: Populated Keyword object</span>
<span class="sd">    :rtype: Keyword</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">eName</span> <span class="o">=</span> <span class="n">entity</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="n">eType</span> <span class="o">=</span> <span class="n">entity</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
    <span class="n">eSal</span> <span class="o">=</span> <span class="n">entity</span><span class="p">[</span><span class="s1">&#39;salience&#39;</span><span class="p">]</span>
    <span class="n">eFreq</span> <span class="o">=</span> <span class="n">getwordfrequency</span><span class="p">(</span><span class="n">eName</span><span class="p">,</span> <span class="n">file_text</span><span class="p">)</span>

    <span class="n">newKeyword</span> <span class="o">=</span> <span class="n">Keyword</span><span class="o">.</span><span class="n">Keyword</span><span class="p">(</span><span class="n">eName</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">eType</span><span class="p">,</span> <span class="n">eSal</span><span class="p">,</span> <span class="n">eFreq</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># the value 0 refers to default keywordscore</span>

    <span class="c1">#for key, value in entity.metadata.items():</span>
        <span class="c1">#newKeyword.metadata[key] = value</span>
    <span class="k">return</span> <span class="n">newKeyword</span></div>


<div class="viewcode-block" id="getwordfrequency"><a class="viewcode-back" href="../functionsv1.html#common_functions.getwordfrequency">[docs]</a><span class="k">def</span> <span class="nf">getwordfrequency</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">file_text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Determines frequency of the given word in the file&#39;s text</span>


<span class="sd">    :param str word: Word to find frequency of</span>
<span class="sd">    :param List[str] file_text: list of string containing entire text of file</span>
<span class="sd">    :return: frequency of word parameter in text</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Only populate longlongfiletext once, it is very inefficient the way it is now.</span>
    <span class="n">longlongfiletext</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">stringlisttolonglongstring</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">longlongfiletext</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">longlongfiletext</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span></div>


<div class="viewcode-block" id="getregulatorydoctext"><a class="viewcode-back" href="../functionsv1.html#common_functions.getregulatorydoctext">[docs]</a><span class="k">def</span> <span class="nf">getregulatorydoctext</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Looks in the &#39;/RegulatoryDocuments&#39; folder for the file with the given *filename* and return&#39;s its text as a</span>
<span class="sd">    list of strings. The :func:`extractpdftext` function is utilized.</span>


<span class="sd">    :param str filename: name of regulatory file without file ending on it</span>
<span class="sd">    :return: file text</span>
<span class="sd">    :rtype: List[str]</span>
<span class="sd">    :raises: FileNotFoundError</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;opening regulatory document&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">REGULATOR_FOLDER</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="n">FileStorage</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

        <span class="n">reg_text</span> <span class="o">=</span> <span class="n">extractpdftext</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">RegDoc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="ow">and</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;could not access regulatory document&quot;&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reg_text</span></div>


<div class="viewcode-block" id="kwhighestfrequencies"><a class="viewcode-back" href="../functionsv1.html#common_functions.kwhighestfrequencies">[docs]</a><span class="k">def</span> <span class="nf">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">,</span> <span class="n">numtopkws</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Returns the top 10 most frequent Keywords in an uploaded file.</span>


<span class="sd">    :param KeywordList keyword_list: List of Keyword objects</span>
<span class="sd">    :param int numtopkws: number of keywords to return.</span>
<span class="sd">    :return: Keywords with highest frequencies</span>
<span class="sd">    :rtype: List[Keyword]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">keyword_list</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
    <span class="n">topkeywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">topKeywordfreqs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># This loop finds the 10 most common keywords in the keyword_list</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numtopkws</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">topkeywordfreq</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">frequency</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span><span class="p">)</span>
        <span class="n">topKeywordfreqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeywordfreq</span><span class="p">)</span>

        <span class="n">topkeyword</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">kw</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">kw</span><span class="o">.</span><span class="n">frequency</span> <span class="o">==</span> <span class="n">topkeywordfreq</span><span class="p">)</span>
        <span class="n">topkeywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeyword</span><span class="p">)</span>

        <span class="n">kwlist</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">word</span> <span class="o">!=</span> <span class="n">topkeyword</span><span class="o">.</span><span class="n">word</span><span class="p">]</span> <span class="c1"># removes the previously added item so it does not get chosen again</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">topkeywords</span></div>

<div class="viewcode-block" id="kwhighestkeyscores"><a class="viewcode-back" href="../functionsv1.html#common_functions.kwhighestkeyscores">[docs]</a><span class="k">def</span> <span class="nf">kwhighestkeyscores</span><span class="p">(</span><span class="n">keyword_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Returns ten Keywords with the highest Keyword scores</span>


<span class="sd">    :param KeywordList keyword_list: list of Keyword objects</span>
<span class="sd">    :return: list of top keyword scores</span>
<span class="sd">    :rtype: List[Keyword]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">keyword_list</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
    <span class="n">topkeywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">topKeywordscores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># This loop finds the 10 highest keyword scores in the keyword_list</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">topkeywordscore</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keywordscore</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span><span class="p">)</span>
        <span class="n">topKeywordscores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeywordscore</span><span class="p">)</span>

        <span class="n">topkeyword</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">kw</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">kw</span><span class="o">.</span><span class="n">keywordscore</span> <span class="o">==</span> <span class="n">topkeywordscore</span><span class="p">)</span>
        <span class="n">topkeywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topkeyword</span><span class="p">)</span>

        <span class="n">kwlist</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwlist</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">word</span> <span class="o">!=</span> <span class="n">topkeyword</span><span class="o">.</span><span class="n">word</span><span class="p">]</span> <span class="c1"># removes the previously added item so it does not get chosen again</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">topkeywords</span></div>


<div class="viewcode-block" id="plotkeywordsalience"><a class="viewcode-back" href="../functionsv1.html#common_functions.plotkeywordsalience">[docs]</a><span class="k">def</span> <span class="nf">plotkeywordsalience</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">,</span> <span class="n">keyword_list2</span><span class="p">,</span> <span class="n">doc1name</span><span class="o">=</span><span class="s1">&#39;doc1&#39;</span><span class="p">,</span> <span class="n">doc2name</span> <span class="o">=</span> <span class="s1">&#39;doc2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Plots salience scores of most frequently used keywords. Pulls keywords from *keyword_list1* and compares</span>
<span class="sd">    against *keyword_list2*. The :mod:`matplotlib` python package is used to aide in plotting the data.</span>

<span class="sd">    If there are no common keywords to plot, a blank plot will display with the title &quot;No Common Keywords to Plot&quot;.</span>

<span class="sd">    :param KeywordList keyword_list1: user KeywordList</span>
<span class="sd">    :param KeywordList keyword_list2: regulatory KeywordList</span>
<span class="sd">    :param str doc1name: user document name</span>
<span class="sd">    :param str doc2name: regulatory document name</span>
<span class="sd">    :return: void</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Clearing previous graph just to be safe</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">kwlist1</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">)</span>
    <span class="n">kwlist2</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list2</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting keyword salience...&quot;</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">)):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">my_xtick</span> <span class="o">=</span> <span class="n">word</span>
                <span class="n">my_xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_xtick</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NO COMMON KEYWORDS TO PLOT&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topsalience.png&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No common keywords to plot&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">))</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;User doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc1name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulatory doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc2name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_xticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Salience of Most Common Keywords In File&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Keywords (in order of frequency in uploaded document)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Salience&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topsalience.png&#39;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plot complete.&quot;</span><span class="p">)</span></div>
    <span class="c1"># pyplot.show()</span>


<div class="viewcode-block" id="plotkeywordscores"><a class="viewcode-back" href="../functionsv1.html#common_functions.plotkeywordscores">[docs]</a><span class="k">def</span> <span class="nf">plotkeywordscores</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">,</span> <span class="n">keyword_list2</span><span class="p">,</span> <span class="n">doc1name</span><span class="o">=</span><span class="s1">&#39;doc1&#39;</span><span class="p">,</span> <span class="n">doc2name</span> <span class="o">=</span> <span class="s1">&#39;doc2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Plots keyword score of the most frequently used keywords. Pulls keywords from *keyword_list1* and compares</span>
<span class="sd">    against *keyword_list2*. The :mod:`matplotlib` python package is used to aide in plotting the data.</span>

<span class="sd">    If there are no common keywords to plot, a blank plot will display with the title &quot;No Common Keywords to Plot&quot;.</span>


<span class="sd">    :param KeywordList keyword_list1: user KeywordList</span>
<span class="sd">    :param KeywordList keyword_list2: regulatory KeywordList</span>
<span class="sd">    :param str doc1name: user document name</span>
<span class="sd">    :param str doc2name: regulatory document name</span>
<span class="sd">    :return: void</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Clearing previous graph just to be safe</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">kwlist1</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestkeyscores</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">)</span>
    <span class="n">kwlist2</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestkeyscores</span><span class="p">(</span><span class="n">keyword_list2</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting keyword scores...&quot;</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">)):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">my_xtick</span> <span class="o">=</span> <span class="n">word</span>
                <span class="n">my_xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_xtick</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keywordscore</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">keywordscore</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NO COMMON KEYWORDS TO PLOT&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordscores.png&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No keyword scores to plot&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">))</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;User doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc1name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulatory doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc2name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_xticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Keyword Score of Most Common Keywords In File&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Keywords (in order of keyword score in uploaded document)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Keyword Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordscores.png&#39;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting complete.&quot;</span><span class="p">)</span></div>
    <span class="c1"># pyplot.show()</span>

<div class="viewcode-block" id="plotkeywordfrequency"><a class="viewcode-back" href="../functionsv1.html#common_functions.plotkeywordfrequency">[docs]</a><span class="k">def</span> <span class="nf">plotkeywordfrequency</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">,</span> <span class="n">keyword_list2</span><span class="p">,</span> <span class="n">doc1name</span><span class="o">=</span><span class="s1">&#39;doc1&#39;</span><span class="p">,</span> <span class="n">doc2name</span> <span class="o">=</span> <span class="s1">&#39;doc2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Plots keyword score of most frequently used keywords. Pulls keywords from *keyword_list1* and compares</span>
<span class="sd">    against *keyword_list2*. The :mod:`matplotlib` python package is used to aide in plotting the data.</span>

<span class="sd">    If there are no common keywords to plot, a blank plot will display with the title &quot;No Common Keywords to Plot&quot;.</span>


<span class="sd">    :param KeywordList keyword_list1: user document keywords</span>
<span class="sd">    :param KeywordList keyword_list2: regulatory document keywords</span>
<span class="sd">    :param str doc1name: name of user document</span>
<span class="sd">    :param str doc2name: name of regulatory document</span>
<span class="sd">    :return: void</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Clearing previous graph just to be safe</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">kwlist1</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list1</span><span class="p">)</span>
    <span class="n">kwlist2</span> <span class="o">=</span> <span class="n">common_functions</span><span class="o">.</span><span class="n">kwhighestfrequencies</span><span class="p">(</span><span class="n">keyword_list2</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting keyword frequency...&quot;</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">)):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">word</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">my_xtick</span> <span class="o">=</span> <span class="n">word</span>
                <span class="n">my_xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_xtick</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwlist2</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NO COMMON KEYWORDS TO PLOT&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordfrequency.png&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No keyword frequency to plot&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">))</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;User doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc1name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulatory doc: &quot;&#39;</span> <span class="o">+</span> <span class="n">doc2name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_xticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Keyword Frequencies of Most Common Keywords In File&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Keywords (in order of keyword score in uploaded document)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">DOWNLOAD_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;topkeywordfrequency.png&#39;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting complete.&quot;</span><span class="p">)</span></div>
    <span class="c1"># pyplot.show()</span>


<div class="viewcode-block" id="printanalytics"><a class="viewcode-back" href="../functionsv1.html#common_functions.printanalytics">[docs]</a><span class="k">def</span> <span class="nf">printanalytics</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">regfilename</span><span class="p">,</span> <span class="n">keywordlist</span><span class="p">,</span> <span class="n">regkeywordlist</span><span class="p">,</span> <span class="n">calctime</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Saves the data passed in the argument to the ever-increasing file &#39;/downloads/Analytics.txt&#39; that contains</span>
<span class="sd">    data analytics information.</span>
<span class="sd">    Analytic information includes:</span>

<span class="sd">    - Date/Time</span>
<span class="sd">    - Processing time</span>
<span class="sd">    - user doc file name and number of keywords</span>
<span class="sd">    - regulatory doc file name and number of keywords</span>


<span class="sd">    :param str filename: name of user document file</span>
<span class="sd">    :param str regfilename: name of regulatory document file</span>
<span class="sd">    :param KeywordList keywordlist: user document Keyword list</span>
<span class="sd">    :param KeywordList regkeywordlist: regulatory document Keyword list.</span>
<span class="sd">    :param int calctime: processing time of app.</span>
<span class="sd">    :return: void</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">str_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># KEEP THIS FORMATTING</span>
    <span class="n">str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39; ; &#39;</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">calctime</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; sec.] ; &#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39; ; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keywordlist</span><span class="o">.</span><span class="n">list</span><span class="p">))</span>\
                    <span class="o">+</span> <span class="s1">&#39; ; &#39;</span> <span class="o">+</span> <span class="n">regfilename</span> <span class="o">+</span> <span class="s1">&#39; ; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">regkeywordlist</span><span class="o">.</span><span class="n">list</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; ; </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">printstr</span> <span class="o">=</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">DOCUMENTS_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;Analytics.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">DOCUMENTS_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;Analytics.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">printstr</span> <span class="o">+</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="generatebubblecsv"><a class="viewcode-back" href="../functionsv1.html#common_functions.generatebubblecsv">[docs]</a><span class="k">def</span> <span class="nf">generatebubblecsv</span><span class="p">(</span><span class="n">kw_list</span><span class="p">,</span> <span class="n">reg_kw_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Creates a new *csv* file with all the keywords. The *csv* file is used to generate the Bubble Chart.</span>


<span class="sd">    :param KeywordList kw_list: list of doc keywords</span>
<span class="sd">    :param KeywordList reg_kw_list: list of reg doc keywords</span>
<span class="sd">    :return: void</span>
<span class="sd">    :raises: Exception</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating Bubble Chart CSV...&quot;</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">DOCUMENTS_FOLDER</span> <span class="o">+</span> <span class="s1">&#39;csvkeywords.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">([</span><span class="s2">&quot;keyword,frequency,salience</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;----------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">])</span>

        <span class="n">breakCount</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">)):</span>
            <span class="c1"># in order to preserve color scheme, keywords from different files must alternate, so if one runs out, we stop.</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;applicationconfig.json&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MAX_BUBBLES&#39;</span><span class="p">]):</span>
                <span class="n">breakCount</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">writeToConfig</span><span class="p">(</span><span class="s2">&quot;ACTUAL_BUBBLES&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">word</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg_kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">salience</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">breakCount</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">writeToConfig</span><span class="p">(</span><span class="s2">&quot;ACTUAL_BUBBLES&quot;</span><span class="p">,</span> <span class="n">breakCount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">writeToConfig</span><span class="p">(</span><span class="s2">&quot;ACTUAL_BUBBLES&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">kw_list</span><span class="o">.</span><span class="n">list</span><span class="p">))</span>

        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bubble Chart CSV generation successful&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bubble Chart CSV generation failed.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="writeToConfig"><a class="viewcode-back" href="../functionsv1.html#common_functions.writeToConfig">[docs]</a><span class="k">def</span> <span class="nf">writeToConfig</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summary: Writes *value* into the &#39;/applicationconfig.json&#39; file.</span>


<span class="sd">    :param str key: variable in which *value* is being written to</span>
<span class="sd">    :param value: value</span>
<span class="sd">    :return: none</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">((</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;applicationconfig.json&#39;</span><span class="p">)))</span>
    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;applicationconfig.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Linguistic Analyzer 2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Paul Brown, Tyler Blanton.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>